<!DOCTYPE html>




<html lang="en">
  <head>
    <meta charset="utf-8" />
    
    <title>Optimizer using Cross Entropy &mdash; L2L 1.0.0-beta documentation</title>
    <meta name="description" content="">
    <meta name="author" content="">

    

<link rel="stylesheet" href="_static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" id="current-theme" href="_static/css/bootstrap3/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" id="current-adjust-theme" type="text/css" />

<link rel="stylesheet" href="_static/css/font-awesome.min.css">

<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
</style>

<link rel="stylesheet" href="_static/css/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    './',
            VERSION:     '1.0.0-beta',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
    <script type="text/javascript" src="_static/js/jquery.min.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/js/bootstrap3.min.js"></script>
<script type="text/javascript" src="_static/js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="_static/js/basicstrap.js"></script>
<script type="text/javascript">
</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="L2L 1.0.0-beta documentation" href="index.html" />
    <link rel="up" title="Optimizers" href="l2l.optimizers.html" />
    <link rel="next" title="Optimizer using FACE" href="l2l.optimizers.face.html" />
    <link rel="prev" title="Optimizers" href="l2l.optimizers.html" /> 
  </head>
  <body role="document">
    <div id="navbar-top" class="navbar navbar-fixed-top navbar-default" role="navigation" aria-label="top navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">L2L 1.0.0-beta documentation</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
              <li class="dropdown visible-xs">
                <a role="button" id="localToc" data-toggle="dropdown" data-target="#" href="#">Table Of Contents <b class="caret"></b></a>
                <ul class="dropdown-menu localtoc sp-localtoc" role="menu" aria-labelledby="localToc">
                <ul>
<li><a class="reference internal" href="#">Optimizer using Cross Entropy</a><ul>
<li><a class="reference internal" href="#crossentropyoptimizer">CrossEntropyOptimizer</a></li>
<li><a class="reference internal" href="#crossentropyparameters">CrossEntropyParameters</a></li>
<li><a class="reference internal" href="#distributions">Distributions</a></li>
</ul>
</li>
</ul>

                </ul>
              </li>

            
              <li><a href="l2l.optimizers.html" title="Optimizers" accesskey="P">previous </a></li>
              <li><a href="l2l.optimizers.face.html" title="Optimizer using FACE" accesskey="N">next </a></li>
              <li><a href="py-modindex.html" title="Python Module Index" >modules </a></li>
              <li><a href="genindex.html" title="General Index" accesskey="I">index </a></li>
              <li><a href="l2l.html" >API Reference</a></li>
              <li><a href="l2l.optimizers.html" accesskey="U">Optimizers</a></li>
            
            <li class="visible-xs"><a href="_sources/l2l.optimizers.crossentropy.rst.txt" rel="nofollow">Show Source</a></li>

            <li class="visible-xs">
                <form class="search form-search form-inline navbar-form navbar-right sp-searchbox" action="search.html" method="get">
                  <div class="input-append input-group">
                    <input type="text" class="search-query form-control" name="q" placeholder="Search...">
                    <span class="input-group-btn">
                    <input type="submit" class="btn" value="Go" />
                    </span>
                  </div>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </li>

            

          </ul>

        </div>
      </div>
    </div>
    

    <!-- container -->
    <div class="container-fluid">

      <!-- row -->
      <div class="row">
         
<div class="col-md-3 hidden-xs" id="sidebar-wrapper">
  <div class="sidebar hidden-xs" role="navigation" aria-label="main navigation">
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="l2l.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="l2l.optimizees.html">Optimizees</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="l2l.optimizers.html">Optimizers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="l2l.optimizers.html#optimizer-base-module">Optimizer Base Module</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="l2l.optimizers.html#implemented-examples">Implemented Examples</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Optimizer using Cross Entropy</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#crossentropyoptimizer">CrossEntropyOptimizer</a></li>
<li class="toctree-l5"><a class="reference internal" href="#crossentropyparameters">CrossEntropyParameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#distributions">Distributions</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="l2l.optimizers.face.html">Optimizer using FACE</a></li>
<li class="toctree-l4"><a class="reference internal" href="l2l.optimizers.gradientdescent.html">Optimizer using Gradient Descent</a></li>
<li class="toctree-l4"><a class="reference internal" href="l2l.optimizers.gridsearch.html">Optimizer using Grid Search</a></li>
<li class="toctree-l4"><a class="reference internal" href="l2l.optimizers.evolution.html">Optimizer using Evolutionary Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="l2l.optimizers.simulatedannealing.html">Optimizer using Simulated Annealing</a></li>
<li class="toctree-l4"><a class="reference internal" href="l2l.optimizers.evolutionstrategies.html">Optimizer using Evolution Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="l2l.optimizers.naturalevolutionstrategies.html">Optimizer using Natural Evolution Strategies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="l2l.utils.html">Simulation control</a></li>
<li class="toctree-l2"><a class="reference internal" href="l2l.logging_tools.html">Logging Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="l2l.html#other-module-functions">Other module functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="l2l-bin.html">L2L Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="indices.html">Indices and tables</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="l2l.optimizers.html"
                        title="previous chapter">Optimizers</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="l2l.optimizers.face.html"
                        title="next chapter">Optimizer using FACE</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/l2l.optimizers.crossentropy.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" role="search">
  <h3>Quick search</h3>
  <form class="search form-inline" action="search.html" method="get">
      <div class="input-append input-group">
        <input type="text" class="search-query form-control" name="q" placeholder="Search...">
        <span class="input-group-btn">
        <input type="submit" class="btn" value="Go" />
        </span>
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div> 
        

        <div class="col-md-9" id="content-wrapper">
          <div class="document" role="main">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  
  <div class="section" id="optimizer-using-cross-entropy">
<h1>Optimizer using Cross Entropy<a class="headerlink" href="#optimizer-using-cross-entropy" title="Permalink to this headline">¶</a></h1>
<div class="section" id="crossentropyoptimizer">
<h2>CrossEntropyOptimizer<a class="headerlink" href="#crossentropyoptimizer" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="l2l.optimizers.crossentropy.optimizer.CrossEntropyOptimizer">
<em class="property">class </em><code class="sig-prename descclassname">l2l.optimizers.crossentropy.optimizer.</code><code class="sig-name descname">CrossEntropyOptimizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">traj</span></em>, <em class="sig-param"><span class="n">optimizee_create_individual</span></em>, <em class="sig-param"><span class="n">optimizee_fitness_weights</span></em>, <em class="sig-param"><span class="n">parameters</span></em>, <em class="sig-param"><span class="n">optimizee_bounding_func</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/optimizer.html#CrossEntropyOptimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyOptimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="l2l.optimizers.html#l2l.optimizers.optimizer.Optimizer" title="l2l.optimizers.optimizer.Optimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">l2l.optimizers.optimizer.Optimizer</span></code></a></p>
<p>Class for a generic cross entropy optimizer.
In the pseudo code the algorithm does:</p>
<dl class="simple">
<dt>For n iterations do:</dt><dd><ul class="simple">
<li><p>Sample individuals from distribution</p></li>
<li><p>evaluate individuals and get fitness</p></li>
<li><p>pick rho * pop_size number of elite individuals</p></li>
<li><p>Out of the remaining non-elite individuals, select them using a simulated-annealing style
selection based on the difference between their fitness and the <cite>1-rho</cite> quantile (<em>gamma</em>)
fitness, and the current temperature</p></li>
<li><p>Fit the distribution family to the new elite individuals by minimizing cross entropy.
The distribution fitting is smoothed to prevent premature convergence to local minima.
A weight equal to the <cite>smoothing</cite> parameter is assigned to the previous parameters when
smoothing.</p></li>
</ul>
</dd>
</dl>
<p>return final distribution parameters.
(The final distribution parameters contain information regarding the location of the maxima)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traj</strong> (<a class="reference internal" href="l2l.utils.html#l2l.utils.trajectory.Trajectory" title="l2l.utils.trajectory.Trajectory"><em>Trajectory</em></a>) – Use this trajectory to store the parameters of the specific runs. The parameters should be
initialized based on the values in <cite>parameters</cite></p></li>
<li><p><strong>optimizee_create_individual</strong> – Function that creates a new individual. All parameters of the Individual-Dict returned should be
of numpy.float64 type</p></li>
<li><p><strong>optimizee_fitness_weights</strong> – Fitness weights. The fitness returned by the Optimizee is multiplied by these values (one for each
element of the fitness vector)</p></li>
<li><p><strong>parameters</strong> – Instance of <a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.namedtuple" title="(in Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">namedtuple()</span></code></a> <a class="reference internal" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters" title="l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossEntropyParameters</span></code></a> containing the
parameters needed by the Optimizer</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="l2l.optimizers.crossentropy.optimizer.CrossEntropyOptimizer.post_process">
<code class="sig-name descname">post_process</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">traj</span></em>, <em class="sig-param"><span class="n">fitnesses_results</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/optimizer.html#CrossEntropyOptimizer.post_process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyOptimizer.post_process" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="l2l.optimizers.html#l2l.optimizers.optimizer.Optimizer.post_process" title="l2l.optimizers.optimizer.Optimizer.post_process"><code class="xref py py-meth docutils literal notranslate"><span class="pre">post_process()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.optimizer.CrossEntropyOptimizer.end">
<code class="sig-name descname">end</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">traj</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/optimizer.html#CrossEntropyOptimizer.end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyOptimizer.end" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="l2l.optimizers.html#l2l.optimizers.optimizer.Optimizer.end" title="l2l.optimizers.optimizer.Optimizer.end"><code class="xref py py-meth docutils literal notranslate"><span class="pre">end()</span></code></a></p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="crossentropyparameters">
<h2>CrossEntropyParameters<a class="headerlink" href="#crossentropyparameters" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters">
<em class="property">class </em><code class="sig-prename descclassname">l2l.optimizers.crossentropy.optimizer.</code><code class="sig-name descname">CrossEntropyParameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pop_size</span></em>, <em class="sig-param"><span class="n">rho</span></em>, <em class="sig-param"><span class="n">smoothing</span></em>, <em class="sig-param"><span class="n">temp_decay</span></em>, <em class="sig-param"><span class="n">n_iteration</span></em>, <em class="sig-param"><span class="n">distribution</span></em>, <em class="sig-param"><span class="n">stop_criterion</span></em>, <em class="sig-param"><span class="n">seed</span></em><span class="sig-paren">)</span><a class="headerlink" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pop_size</strong> – Minimal number of individuals per simulation.</p></li>
<li><p><strong>rho</strong> – Fraction of solutions to be considered elite in each iteration.</p></li>
<li><p><strong>smoothing</strong> – <p>This is a factor between 0 and 1 that determines the weight assigned to the previous distribution
parameters while calculating the new distribution parameters. The smoothing is done as a linear combination of the 
optimal parameters for the current data, and the previous distribution as follows:</p>
<blockquote>
<div><p>new_params = smoothing * old_params + (1 - smoothing) * optimal_new_params</p>
</div></blockquote>
</p></li>
<li><p><strong>temp_decay</strong> – This parameter is the factor (necessarily between 0 and 1) by which the temperature decays each
generation. To see the use of temperature, look at the documentation of <a class="reference internal" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyOptimizer" title="l2l.optimizers.crossentropy.optimizer.CrossEntropyOptimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossEntropyOptimizer</span></code></a></p></li>
<li><p><strong>n_iteration</strong> – Number of iterations to perform</p></li>
<li><p><strong>distribution</strong> – Distribution object to use. Has to implement a fit and sample function. Should be one of 
<a class="reference internal" href="#l2l.optimizers.crossentropy.distribution.Gaussian" title="l2l.optimizers.crossentropy.distribution.Gaussian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gaussian</span></code></a>, <a class="reference internal" href="#l2l.optimizers.crossentropy.distribution.NoisyGaussian" title="l2l.optimizers.crossentropy.distribution.NoisyGaussian"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoisyGaussian</span></code></a>, <a class="reference internal" href="#l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture" title="l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture"><code class="xref py py-class docutils literal notranslate"><span class="pre">BayesianGaussianMixture</span></code></a>, <a class="reference internal" href="#l2l.optimizers.crossentropy.distribution.NoisyBayesianGaussianMixture" title="l2l.optimizers.crossentropy.distribution.NoisyBayesianGaussianMixture"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoisyBayesianGaussianMixture</span></code></a></p></li>
<li><p><strong>stop_criterion</strong> – (Optional) Stop if this fitness is reached.</p></li>
<li><p><strong>seed</strong> – The random seed used to sample and fit the distribution. <a class="reference internal" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyOptimizer" title="l2l.optimizers.crossentropy.optimizer.CrossEntropyOptimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossEntropyOptimizer</span></code></a>
uses a random generator seeded with this seed.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.distribution">
<em class="property">property </em><code class="sig-name descname">distribution</code><a class="headerlink" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.distribution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.n_iteration">
<em class="property">property </em><code class="sig-name descname">n_iteration</code><a class="headerlink" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.n_iteration" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.pop_size">
<em class="property">property </em><code class="sig-name descname">pop_size</code><a class="headerlink" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.pop_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.rho">
<em class="property">property </em><code class="sig-name descname">rho</code><a class="headerlink" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.rho" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.seed">
<em class="property">property </em><code class="sig-name descname">seed</code><a class="headerlink" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.seed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.smoothing">
<em class="property">property </em><code class="sig-name descname">smoothing</code><a class="headerlink" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.smoothing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.stop_criterion">
<em class="property">property </em><code class="sig-name descname">stop_criterion</code><a class="headerlink" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.stop_criterion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.temp_decay">
<em class="property">property </em><code class="sig-name descname">temp_decay</code><a class="headerlink" href="#l2l.optimizers.crossentropy.optimizer.CrossEntropyParameters.temp_decay" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="distributions">
<h2>Distributions<a class="headerlink" href="#distributions" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="l2l.optimizers.crossentropy.distribution.Distribution">
<em class="property">class </em><code class="sig-prename descclassname">l2l.optimizers.crossentropy.distribution.</code><code class="sig-name descname">Distribution</code><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#Distribution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.Distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Generic base for a distribution. Needs to implement the functions fit and sample.</p>
<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.Distribution.init_random_state">
<em class="property">abstract </em><code class="sig-name descname">init_random_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">random_state</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#Distribution.init_random_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.Distribution.init_random_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to initialize the random number generator which is used to fit/sample data. Note
that if the random_state is already set, this raises an <cite>AssertionError</cite>. The reason
this is not a part of the constructor is that the distribution random state must be
initialized only by the optimizer and not in the main function (where it is
constructed). It is essential to call this function before using the distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>random_state</strong> – An instance of class:<cite>numpy.random.RandomState</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.Distribution.fit">
<em class="property">abstract </em><code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#Distribution.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.Distribution.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>This function fits the distributions parameters to the given samples
in maximum likelihood fashion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_list</strong> – A list or array of individuals to fit to.</p>
</dd>
<dt class="field-even">Return dict</dt>
<dd class="field-even"><p>a dict describing the current parametrization</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.Distribution.sample">
<em class="property">abstract </em><code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_individuals</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#Distribution.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.Distribution.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples n_individuals from the current parametrized distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_individuals</strong> – An integer specifying the amount of individuals to sample</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list or array of n_individuals</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.Distribution.get_params">
<em class="property">abstract </em><code class="sig-name descname">get_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#Distribution.get_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.Distribution.get_params" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the parametrization of the distribution as a dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="l2l.optimizers.crossentropy.distribution.Gaussian">
<em class="property">class </em><code class="sig-prename descclassname">l2l.optimizers.crossentropy.distribution.</code><code class="sig-name descname">Gaussian</code><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#Gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.Gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#l2l.optimizers.crossentropy.distribution.Distribution" title="l2l.optimizers.crossentropy.distribution.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">l2l.optimizers.crossentropy.distribution.Distribution</span></code></a></p>
<p>Gaussian distribution.</p>
<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.Gaussian.init_random_state">
<code class="sig-name descname">init_random_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">random_state</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#Gaussian.init_random_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.Gaussian.init_random_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to initialize the random number generator which is used to fit/sample data. Note
that if the random_state is already set, this raises an <cite>AssertionError</cite>. The reason
this is not a part of the constructor is that the distribution random state must be
initialized only by the optimizer and not in the main function (where it is
constructed). It is essential to call this function before using the distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>random_state</strong> – An instance of class:<cite>numpy.random.RandomState</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.Gaussian.get_params">
<code class="sig-name descname">get_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#Gaussian.get_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.Gaussian.get_params" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the parametrization of the distribution as a dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.Gaussian.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_list</span></em>, <em class="sig-param"><span class="n">smooth_update</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#Gaussian.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.Gaussian.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a gaussian distribution to the given data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_list</strong> – list or numpy array with individuals as rows</p></li>
<li><p><strong>smooth_update</strong> – determines to which extent the new samples account for the new distribution.
default is 0 -&gt; old parameters are fully discarded</p></li>
</ul>
</dd>
<dt class="field-even">Return dict</dt>
<dd class="field-even"><p>specifying current parametrization</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.Gaussian.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_individuals</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#Gaussian.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.Gaussian.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample n_individuals individuals under the current parametrization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_individuals</strong> – number of individuals to sample.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array with n_individual rows of individuals</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="l2l.optimizers.crossentropy.distribution.NoisyGaussian">
<em class="property">class </em><code class="sig-prename descclassname">l2l.optimizers.crossentropy.distribution.</code><code class="sig-name descname">NoisyGaussian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">noise_magnitude</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">coordinate_scale</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">noise_decay</span><span class="o">=</span><span class="default_value">0.95</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#NoisyGaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.NoisyGaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#l2l.optimizers.crossentropy.distribution.Gaussian" title="l2l.optimizers.crossentropy.distribution.Gaussian"><code class="xref py py-class docutils literal notranslate"><span class="pre">l2l.optimizers.crossentropy.distribution.Gaussian</span></code></a></p>
<p>Additive Noisy Gaussian distribution. The initialization of its noise components
happens during the first fit where the magnitude of the noise in each
diagonalized component is estimated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise_magnitude</strong> – scalar factor that affects the magnitude of noise
applied on the distribution parameters</p></li>
<li><p><strong>coordinate_scale</strong> – This should be a vector representing the scaling of
the coordinates. The noise applied to each coordinate <cite>i</cite> is
<cite>noise_magnitude*coordinate_scale[i]</cite></p></li>
<li><p><strong>noise_decay</strong> – Multiplicative decay of the noise components</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.NoisyGaussian.get_params">
<code class="sig-name descname">get_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#NoisyGaussian.get_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.NoisyGaussian.get_params" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the parametrization of the distribution as a dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.NoisyGaussian.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_list</span></em>, <em class="sig-param"><span class="n">smooth_update</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#NoisyGaussian.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.NoisyGaussian.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the parameters to the given data (see <a class="reference internal" href="#l2l.optimizers.crossentropy.distribution.Gaussian" title="l2l.optimizers.crossentropy.distribution.Gaussian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gaussian</span></code></a>) and additionally
adds noise in form of variance to the covariance matrix. Also, the noise
is decayed after each step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_list</strong> – Data to be fitted to</p></li>
<li><p><strong>smooth_update</strong> – Smooth the parameter update with regard to the
previous configuration</p></li>
</ul>
</dd>
<dt class="field-even">Return dict</dt>
<dd class="field-even"><p>describing parameter configuration</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.NoisyGaussian.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_individuals</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#NoisyGaussian.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.NoisyGaussian.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples from current parametrization</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>n_individuals Individuals</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture">
<em class="property">class </em><code class="sig-prename descclassname">l2l.optimizers.crossentropy.distribution.</code><code class="sig-name descname">BayesianGaussianMixture</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_components</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#BayesianGaussianMixture"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#l2l.optimizers.crossentropy.distribution.Distribution" title="l2l.optimizers.crossentropy.distribution.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">l2l.optimizers.crossentropy.distribution.Distribution</span></code></a></p>
<p>BayesianGaussianMixture from sklearn</p>
<p>Unlike normal Gaussian mixture, the algorithm has tendency to set the weights of
non present modes close to zero. Meaning that it effectively inferences the
number of active modes present in the given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_components</strong> – components of the mixture model</p></li>
<li><p><strong>kwargs</strong> – Additional arguments that get passed on to <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.mixture.BayesianGaussianMixture.html#sklearn.mixture.BayesianGaussianMixture" title="(in scikit-learn v0.24)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.mixture.BayesianGaussianMixture</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture.init_random_state">
<code class="sig-name descname">init_random_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">random_state</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#BayesianGaussianMixture.init_random_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture.init_random_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to initialize the random number generator which is used to fit/sample data. Note
that if the random_state is already set, this raises an <cite>AssertionError</cite>. The reason
this is not a part of the constructor is that the distribution random state must be
initialized only by the optimizer and not in the main function (where it is
constructed). It is essential to call this function before using the distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>random_state</strong> – An instance of class:<cite>numpy.random.RandomState</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture.get_params">
<code class="sig-name descname">get_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#BayesianGaussianMixture.get_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture.get_params" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the parametrization of the distribution as a dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_list</span></em>, <em class="sig-param"><span class="n">smooth_update</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#BayesianGaussianMixture.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits data_list on the parametrized model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_list</strong> – list or numpy array with individuals as rows</p></li>
<li><p><strong>smooth_update</strong> – determines to which extent the new samples account for the
new distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dict specifiying current parametrization</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_individuals</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#BayesianGaussianMixture.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample n_individuals individuals under the current parametrization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_individuals</strong> – number of individuals to sample</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array with n_individuals rows of individuals</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="l2l.optimizers.crossentropy.distribution.NoisyBayesianGaussianMixture">
<em class="property">class </em><code class="sig-prename descclassname">l2l.optimizers.crossentropy.distribution.</code><code class="sig-name descname">NoisyBayesianGaussianMixture</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_components</span></em>, <em class="sig-param"><span class="n">noise_magnitude</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">coordinate_scale</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">noise_decay</span><span class="o">=</span><span class="default_value">0.95</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#NoisyBayesianGaussianMixture"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.NoisyBayesianGaussianMixture" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture" title="l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture"><code class="xref py py-class docutils literal notranslate"><span class="pre">l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture</span></code></a></p>
<p>NoisyBayesianGaussianMixture is basically the same as BayesianGaussianMixture
but superimposed with noise</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_components</strong> – number of components in the mixture model</p></li>
<li><p><strong>noise_magnitude</strong> – scalar factor that affects the magnitude of noise
applied on the fitted distribution parameters+</p></li>
<li><p><strong>coordinate_scale</strong> – <p>This should be a vector representing the scaling of
the coordinates. The noise applied to each coordinate <cite>i</cite> is</p>
<blockquote>
<div><p>noise_magnitude * coordinate_scale[i]</p>
</div></blockquote>
<p>Defaults to 1 for each coordinate.</p>
</p></li>
<li><p><strong>noise_decay</strong> – factor that will decay the additive noise</p></li>
<li><p><strong>kwargs</strong> – additional arguments that get passed on to
<a class="reference internal" href="#l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture" title="l2l.optimizers.crossentropy.distribution.BayesianGaussianMixture"><code class="xref py py-class docutils literal notranslate"><span class="pre">BayesianGaussianMixture</span></code></a> distribution</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="l2l.optimizers.crossentropy.distribution.NoisyBayesianGaussianMixture.get_params">
<code class="sig-name descname">get_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/l2l/optimizers/crossentropy/distribution.html#NoisyBayesianGaussianMixture.get_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#l2l.optimizers.crossentropy.distribution.NoisyBayesianGaussianMixture.get_params" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the parametrization of the distribution as a dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


                </div>
              </div>
            </div>
          </div>
        </div>
        
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row footer-relbar">
<div id="navbar-related" class=" related navbar navbar-default" role="navigation" aria-label="related navigation">
  <div class="navbar-inner">
    <ul class="nav navbar-nav ">
        <li><a href="index.html">L2L 1.0.0-beta documentation</a></li>
    </ul>
<ul class="nav navbar-nav pull-right hidden-xs hidden-sm">
      
        <li><a href="l2l.optimizers.html" title="Optimizers" >previous</a></li>
        <li><a href="l2l.optimizers.face.html" title="Optimizer using FACE" >next</a></li>
        <li><a href="py-modindex.html" title="Python Module Index" >modules</a></li>
        <li><a href="genindex.html" title="General Index" >index</a></li>
        <li><a href="l2l.html" >API Reference</a></li>
        <li><a href="l2l.optimizers.html" >Optimizers</a></li>
        <li><a href="#">top</a></li> 
      
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->
      <footer role="contentinfo">
          &copy; Copyright 2017, Anand Subramoney.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.3.0.
      </footer>
      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>